<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<meta charset="UTF-8">
<head>
    <style>
        button {
            display: inline-block;
            margin-top: 10px; /* 버튼 상단 여백을 조절할 수 있습니다. */
        }
    </style>
</head>
<body>
<form id="yourFormId" action="#" th:action="@{/cartItem/addcartItem}" th:object="${multiFormDto}" method="post" onsubmit="return false;">

    <label for="cartItemReqDto.quantity">quantity</label>
    <input type="number" th:field="*{cartItemReqDto.quantity}" id="cartItemReqDto.quantity" oninput="calculateSubtotal()">
    <span th:if="${#fields.hasErrors('cartItemReqDto.quantity')}" th:errors="*{cartItemReqDto.quantity}"></span>
    <br/>

    <label for="cartItemReqDto.subTotal">subTotal</label>
    <input type="text" th:field="*{cartItemReqDto.subTotal}" id="cartItemReqDto.subTotal">
    <span th:if="${#fields.hasErrors('cartItemReqDto.subTotal')}" th:errors="*{cartItemReqDto.subTotal}"></span>
    <br/>

    <label for="productResDTO.price">unitPrice</label>
    <input type="text" th:field="*{productResDTO.price}" id="productResDTO.price">
    <span th:if="${#fields.hasErrors('productResDTO.price')}" th:errors="*{productResDTO.price}"></span>
    <br/>

    <label for="cartResDto.id">cart_id</label>
    <input type="text" th:field="*{cartResDto.id}" id="cartResDto.id">
    <span th:if="${#fields.hasErrors('cartResDto.id')}" th:errors="*{cartResDto.id}"></span>
    <br/>

    <label for="productResDTO.id">product_id</label>
    <input type="hidden" th:field="*{productResDTO.id}" id="productResDTO.id">
    <span th:if="${#fields.hasErrors('productResDTO.id')}" th:errors="*{productResDTO.id}"></span>
    <br/>

    <button id="submitButton">장바구니 담기</button>  <!--submit을 제어하기위해 submit을 없애고 전부 버튼태그로 지정-->

    <button onclick="increaseQuantity()">수량추가</button>
    <button onclick="decreaseQuantity()">수량제거</button>
</form>

<script th:inline="javascript">
    /*<![CDATA[*/
    function increaseQuantity() {
        var quantity = parseInt(document.getElementById("cartItemReqDto.quantity").value);
        quantity += 1;
        document.getElementById("cartItemReqDto.quantity").value = quantity;
        calculateSubtotal();
    }

    function decreaseQuantity() {
        var quantity = parseInt(document.getElementById("cartItemReqDto.quantity").value);
        quantity -= 1;
        if (quantity >= 0) {
            document.getElementById("cartItemReqDto.quantity").value = quantity;
            calculateSubtotal();
        } else {
            alert("더이상 수량을 제거할수 없습니다.");
        }
    }

    function calculateSubtotal() {
        var quantity = document.getElementById("cartItemReqDto.quantity").value;
        var unitPrice = document.getElementById("productResDTO.price").value;

        // quantity와 unitPrice가 숫자인지 확인
        if (!isNaN(quantity) && !isNaN(unitPrice)) {
            var subtotal = quantity * unitPrice;
            document.getElementById("cartItemReqDto.subTotal").value = subtotal;
        } else {
            // 에러 처리: 유효한 숫자가 아닌 경우 메시지 표시 또는 다른 처리 수행
            alert("유효한 숫자가 아닙니다.");
        }
    }
    /*]]>*/

    document.getElementById("submitButton").onclick = function() {
        // 폼을 제출
        document.getElementById("yourFormId").submit();
    };
</script>

</body>
</html>